# Hooksè¯¦ç»†ä»‹ç»
Fiber(v16) å…ˆå‡ºç°ï¼ŒHooks(v16.8)æ‰å‡ºç°çš„

React Hooks ä¾èµ–ã€Œè°ƒç”¨é¡ºåºã€æ•°é‡çš„ç¨³å®šæ€§ã€æ¥ç»´æŠ¤å†…éƒ¨çŠ¶æ€ä¸ Hook çš„æ˜ å°„å…³ç³»ï¼Œç ´åé¡ºåºä¼šå¯¼è‡´çŠ¶æ€é”™ä¹±ã€å†…å­˜æ³„æ¼ç­‰ä¸¥é‡é—®é¢˜

ä¸¥ç¦åœ¨æ¡ä»¶åˆ¤æ–­ã€å¾ªç¯ã€åµŒå¥—å‡½æ•°ï¼ˆå¦‚useEffect å†…éƒ¨ã€äº‹ä»¶å¤„ç†å‡½æ•°ï¼‰ã€å—çº§ä½œç”¨åŸŸï¼ˆå¦‚ {} åŒ…è£¹çš„ä»£ç å—ï¼‰ä¸­è°ƒç”¨ Hook â€”â€” è¿™äº›åœºæ™¯ä¼šå¯¼è‡´æ¯æ¬¡ç»„ä»¶æ¸²æŸ“æ—¶ï¼ŒHook çš„è°ƒç”¨é¡ºåºå‘ç”Ÿå˜åŒ–ã€‚

åº•å±‚åŸç†ï¼š
**React å†…éƒ¨é€šè¿‡ä¸€ä¸ªã€Œå•å‘é“¾è¡¨ã€ç»´æŠ¤ç»„ä»¶çš„ Hook çŠ¶æ€**ï¼Œé“¾è¡¨çš„ç´¢å¼•å®Œå…¨ä¾èµ– Hook çš„è°ƒç”¨é¡ºåº â€”â€” æ¯æ¬¡ç»„ä»¶æ¸²æŸ“æ—¶ï¼ŒReact ä¼šæŒ‰é¡ºåºéå† Hook è°ƒç”¨ï¼Œå°†çŠ¶æ€ï¼ˆå¦‚ useState çš„å€¼ã€useEffect çš„ä¾èµ–ï¼‰ä¸é“¾è¡¨ä¸­çš„å¯¹åº”èŠ‚ç‚¹å…³è”ã€‚

> React å¯¹ Hook çš„è®°å¿†æ˜¯ â€œæŒ‰é¡ºåºè®°ä½ç½®â€ï¼Œè€Œä¸æ˜¯ â€œæŒ‰åç§°è®°â€ã€‚

## ä»¥useStateä¸ºä¾‹ï¼š
1. åº•å±‚å·¥ä½œåŸç†
React å†…éƒ¨é€šè¿‡ **å•å‘é“¾è¡¨**å­˜å‚¨ç»„ä»¶çš„æ‰€æœ‰ useState çŠ¶æ€ï¼šæ¯ä¸ª useState è°ƒç”¨å¯¹åº”é“¾è¡¨ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹å­˜å‚¨çŠ¶æ€å€¼ã€æ›´æ–°å‡½æ•°ï¼ˆsetXxxï¼‰ï¼›

ç»„ä»¶æ¯æ¬¡æ¸²æŸ“æ—¶ï¼ŒReact **æŒ‰ã€ŒuseState è°ƒç”¨é¡ºåºã€éå†é“¾è¡¨ï¼Œå°†çŠ¶æ€å€¼æ˜ å°„åˆ°å¯¹åº”çš„å˜é‡**ï¼ˆå¦‚ countï¼‰ï¼Œä¿è¯çŠ¶æ€ä¸å˜é‡çš„æ­£ç¡®å…³è”ï¼ˆè¿™ä¹Ÿæ˜¯ **Hooks å¿…é¡»åœ¨ç»„ä»¶é¡¶å±‚è°ƒç”¨**çš„åŸå› ï¼‰ï¼›

```js
function Counter() {
  // è°ƒç”¨é¡ºåº 1ï¼šæ‰§è¡Œ useState(0)
  const [count, setCount] = useState(0);
  // è°ƒç”¨é¡ºåº 2ï¼šæ‰§è¡Œ useEffect(...)
  useEffect(() => {}, []);
  // è°ƒç”¨é¡ºåº 3ï¼šæ‰§è¡Œ useState("")
  const [name, setName] = useState("");

  return <div>{count} - {name}</div>;
}
```

Hooksçš„â€œè°ƒç”¨é¡ºåºâ€ï¼ˆä»£ç å±‚é¢ï¼‰å†³å®šäº† Hook é“¾è¡¨çš„ä¸²è”é¡ºåºï¼ˆç¬¬ 1 æ¬¡è°ƒç”¨å¯¹åº”é“¾è¡¨ç¬¬ 1 ä¸ªèŠ‚ç‚¹ï¼Œä»¥æ­¤ç±»æ¨ï¼‰ã€‚

### ä»¥ä¸‹å‡ ç§æƒ…å†µéƒ½æ˜¯é”™çš„
```js
function Counter() {
  const [isShow, setIsShow] = useState(false);

  // âŒ é”™è¯¯ 1ï¼šHook è°ƒç”¨åœ¨ if æ¡ä»¶ä¸­ï¼ˆå¯èƒ½è·³è¿‡ï¼‰
  if (isShow) {
    const [count, setCount] = useState(0); // å½“ isShow ä¸º false æ—¶ï¼Œè¿™ä¸ªè°ƒç”¨ä¸æ‰§è¡Œï¼Œé¡ºåºæ‰“ä¹±
  }

  // âŒ é”™è¯¯ 2ï¼šHook è°ƒç”¨åœ¨ for å¾ªç¯ä¸­ï¼ˆæ•°é‡åŠ¨æ€å˜åŒ–ï¼‰
  const list = [1, 2, 3];
  list.forEach(item => {
    const [value, setValue] = useState(item); // å¾ªç¯æ¬¡æ•°å˜äº†ï¼ŒHook æ•°é‡ä¹Ÿå˜
  });

  // âŒ é”™è¯¯ 3ï¼šHook è°ƒç”¨åœ¨åµŒå¥—å‡½æ•°ä¸­ï¼ˆæ‰§è¡Œæ—¶æœºä¸ç¡®å®šï¼‰
  const handleClick = () => {
    const [name, setName] = useState(""); // åªæœ‰ç‚¹å‡»æ—¶æ‰æ‰§è¡Œï¼Œé¦–æ¬¡æ¸²æŸ“ä¸æ‰§è¡Œï¼Œé¡ºåºæ‰“ä¹±
  };

  // âŒ é”™è¯¯ 4ï¼šHook è°ƒç”¨åœ¨å—çº§ä½œç”¨åŸŸä¸­ï¼ˆç­‰ä»·äºæ¡ä»¶é™åˆ¶ï¼‰
  {
    const [age, setAge] = useState(18); // çœ‹ä¼¼é¡¶å±‚ï¼Œå®åˆ™å—çº§ä½œç”¨åŸŸï¼Œè‹¥åŠ æ¡ä»¶ä¼šè·³è¿‡
  }

  return <button onClick={handleClick}>ç‚¹å‡»</button>;
}
```
æ¯æ¬¡æ¸²æŸ“æ—¶ Hook è°ƒç”¨çš„ **é¡ºåº** æˆ–**æ•°é‡**ä¸ä¸€è‡´ï¼ŒReact éå†é“¾è¡¨æ—¶ä¼šåŒ¹é…åˆ°é”™è¯¯çš„èŠ‚ç‚¹ï¼Œå¯¼è‡´çŠ¶æ€é”™ä¹±ã€æ§åˆ¶å°æŠ¥é”™ã€‚

å®¹æ˜“è¢«æ··æ·†çš„æƒ…å†µï¼š
```js
function Counter() {
  const [isLogin, setIsLogin] = useState(false);

  // âŒ é”™è¯¯ï¼šçŸ­è·¯é€»è¾‘å¯¼è‡´ Hook è°ƒç”¨å¯èƒ½ä¸æ‰§è¡Œï¼ˆç­‰ä»·äº if æ¡ä»¶ï¼‰
  isLogin && useState("userInfo"); // å½“ isLogin ä¸º false æ—¶ï¼Œè¿™ä¸ª Hook ä¸æ‰§è¡Œ

  // âœ… æ­£ç¡®ï¼šå…ˆè°ƒç”¨ Hookï¼ˆé¡¶å±‚ï¼‰ï¼Œå†æ¡ä»¶ä½¿ç”¨çŠ¶æ€
  const [userInfo, setUserInfo] = useState(null);
  if (isLogin) {
    fetch("/api/user").then(setUserInfo);
  }

  return <div></div>;
}
```

### éœ€æ³¨æ„ğŸ“¢ï¼š
Hooksçš„è°ƒç”¨é¡ºåºã€è®¿é—®é¡ºåºçš„æ ¸å¿ƒæ˜¯ Hooks æœ¬èº«ï¼ˆå¦‚ useStateã€useEffectï¼‰çš„æ‰§è¡Œé¡ºåºï¼Œå’Œæ›´æ–°å‡½æ•°ï¼ˆå¦‚ setCountï¼‰æ— å…³ï¼›

ç»å¯¹ä¸èƒ½å‡ºç°åœ¨æ¡ä»¶ã€å¾ªç¯ã€åµŒå¥—ä½œç”¨åŸŸçš„ä¹Ÿæ˜¯Hooksæœ¬èº«ï¼Œå’Œå…¶æ›´æ–°å‡½æ•°æ— å…³ã€‚

## è‡ªå®šä¹‰Hooks
å¿…é¡»éµå®ˆçš„2ä¸ªåŸåˆ™ï¼š
* å‘½åå¿…é¡»ä»¥ use å¼€å¤´
* åªèƒ½åœ¨ å‡½æ•°ç»„ä»¶å†…éƒ¨ æˆ– å…¶ä»–è‡ªå®šä¹‰Hookså†…éƒ¨ è°ƒç”¨ï¼Œä¸èƒ½åœ¨æ™®é€šå‡½æ•°ã€æ¡ä»¶åˆ¤æ–­ã€å¾ªç¯ä¸­è°ƒç”¨ï¼ˆå’Œå†…ç½® Hooks è§„åˆ™ä¸€è‡´ï¼‰ã€‚


ç¤ºä¾‹ï¼šå°è£…è¡¨å•çŠ¶æ€ï¼ˆuseFormï¼‰
```js
import { useState } from 'react';

// è‡ªå®šä¹‰ Hooksï¼šå°è£…è¡¨å•é€»è¾‘
function useForm(initialValues) {
  // 1. å†…éƒ¨ç»´æŠ¤è¡¨å•çŠ¶æ€ï¼ˆè°ƒç”¨å†…ç½® Hooksï¼‰
  const [formData, setFormData] = useState(initialValues);

  // 2. å°è£…è¡¨å•æ“ä½œæ–¹æ³•ï¼ˆå¯å¤ç”¨é€»è¾‘ï¼‰
  // è¾“å…¥æ¡†å˜åŒ–æ—¶æ›´æ–°çŠ¶æ€
  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({ ...prev, [name]: value }));
  };

  // é‡ç½®è¡¨å•åˆ°åˆå§‹å€¼
  const resetForm = () => {
    setFormData(initialValues);
  };

  // 3. æš´éœ²ç»™ç»„ä»¶çš„çŠ¶æ€å’Œæ–¹æ³•ï¼ˆæ•°ç»„/å¯¹è±¡å‡å¯ï¼Œæ¨èå¯¹è±¡æ›´æ¸…æ™°ï¼‰
  return {
    formData,    // è¡¨å•æ•°æ®
    handleChange,// è¾“å…¥æ¡†å˜åŒ–äº‹ä»¶
    resetForm    // é‡ç½®æ–¹æ³•
  };
}
```

ä½¿ç”¨ï¼š
```js
// ç»„ä»¶ä¸­ä½¿ç”¨è‡ªå®šä¹‰ Hooks
function LoginForm() {
  // è°ƒç”¨è‡ªå®šä¹‰ Hooksï¼Œä¼ å…¥åˆå§‹å€¼
  const { formData, handleChange, resetForm } = useForm({
    username: '',
    password: ''
  });
   const handleSubmit = (e) => {
    e.preventDefault();
    console.log('æäº¤è¡¨å•ï¼š', formData); // { username: "xxx", password: "xxx" }
  };

  return (
    <form onSubmit={handleSubmit}>
      <input
        type="text"
        name="username" // å¿…é¡»å’Œ formData çš„ key ä¸€è‡´
        value={formData.username}
        onChange={handleChange}
        placeholder="ç”¨æˆ·å"
      />
      <input
        type="password"
        name="password"
        value={formData.password}
        onChange={handleChange}
        placeholder="å¯†ç "
      />
      <button type="submit">ç™»å½•</button>
      <button type="button" onClick={resetForm}>é‡ç½®</button>
    </form>
  );~
}
```